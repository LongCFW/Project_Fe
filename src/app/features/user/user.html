<main>
  <section id="long">
    <div class="container user-container">
      <!-- üåü PH·∫¶N TI√äU ƒê·ªÄ CH√çNH -->
      <h2 class="text-center fw-semibold mb-4 page-title">Account</h2>

      <!-- ‚úÖ GI·ªöI H·∫†N KHUNG N·ªòI DUNG TRUNG T√ÇM -->
      <div class="content-wrapper mx-auto">

        <!-- üîπ HI·ªÇN TH·ªä TI√äU ƒê·ªÄ FORM (ch·ªâ hi·ªán khi ch∆∞a ƒëƒÉng nh·∫≠p) -->
        <h2 *ngIf="!currentUser" class="fw-semibold mb-3 form-title">
          {{ formTitle }}
        </h2>

        <!-- =========================================================
             üîê LOGIN FORM (ƒêƒÇNG NH·∫¨P)
             ========================================================= -->
        <form *ngIf="showLogin" (ngSubmit)="onLogin()" class="auth-form">
          <!-- üì© Email -->
          <div class="mb-3">
            <input [(ngModel)]="loginData.email" name="loginEmail" type="email" class="form-control form-control-custom"
              placeholder="Email" required>
            <!-- ‚ö†Ô∏è Th√¥ng b√°o l·ªói ƒëƒÉng nh·∫≠p -->
            <span *ngIf="loginError" class="error-text">
              Email or password invalid
            </span>
          </div>

          <!-- üîë M·∫≠t kh·∫©u -->
          <div class="mb-3">
            <input [(ngModel)]="loginData.password" name="loginPassword" type="password"
              class="form-control form-control-custom" placeholder="Password" required>
          </div>

          <!-- üö™ N√∫t ƒëƒÉng nh·∫≠p -->
          <button type="submit" class="btn btn-login w-100">Login</button>

          <!-- üîÅ Chuy·ªÉn sang form ƒëƒÉng k√Ω -->
          <p class="text-center mt-3">
            Don't have an account?
            <button type="button" class="link-btn" (click)="switchForm('signup')">
              Sign up
            </button>
          </p>
        </form>

        <!-- =========================================================
             üìù SIGN UP FORM (ƒêƒÇNG K√ù)
             ========================================================= -->
        <form *ngIf="showSignup" (ngSubmit)="onSignup()" class="auth-form">
          <!-- üë§ H·ªç t√™n -->
          <div class="mb-3">
            <input [(ngModel)]="signupData.name" name="signupName" type="text" class="form-control form-control-custom"
              placeholder="Full Name" required>
          </div>

          <!-- üìß Email -->
          <div class="mb-3">
            <input [(ngModel)]="signupData.email" name="signupEmail" type="email"
              class="form-control form-control-custom" placeholder="Email" required>
          </div>

          <!-- üîí M·∫≠t kh·∫©u -->
          <div class="mb-3">
            <input [(ngModel)]="signupData.password" name="signupPassword" type="password"
              class="form-control form-control-custom" placeholder="Password" required>
          </div>

          <!-- üÜï N√∫t ƒëƒÉng k√Ω -->
          <button type="submit" class="btn btn-login w-100">Sign Up</button>

          <!-- üîÅ Chuy·ªÉn v·ªÅ form ƒëƒÉng nh·∫≠p -->
          <p class="text-center mt-3">
            Already have an account?
            <button type="button" class="link-btn" (click)="switchForm('login')">
              Sign in
            </button>
          </p>
        </form>

        <!-- =========================================================
             üôç USER INFO (TH√îNG TIN NG∆Ø·ªúI D√ôNG)
             ========================================================= -->
        <div *ngIf="currentUser" class="user-info text-center mt-4">
          <h3>{{ currentUser.name }}</h3>
          <p class="text-muted">{{ currentUser.email }}</p>

          <!-- üîì ƒêƒÉng xu·∫•t -->
          <button id="logout-btn" (click)="logout()">ƒêƒÉng xu·∫•t</button>
        </div>

        <!-- =========================================================
             üõçÔ∏è PURCHASE HISTORY (L·ªäCH S·ª¨ MUA H√ÄNG)
             ========================================================= -->
        <div *ngIf="currentUser" class="purchase-history mt-5">
          <!-- üßæ Ti√™u ƒë·ªÅ -->
          <h3 class="history-title mb-4 text-center">L·ªãch s·ª≠ mua h√†ng</h3>

          <!-- ‚úÖ C√≥ ƒë∆°n h√†ng -->
          <div *ngIf="orders.length > 0; else noOrder">
            <div *ngFor="let order of orders" class="order-card">
              <!-- üìÖ Th√¥ng tin ƒë∆°n h√†ng -->
              <div class="order-header">
                <strong class="order-id">ƒê∆°n h√†ng #{{ order.id }}</strong>
                <span class="order-date">{{ order.date | date: 'dd/MM/yyyy, HH:mm' }}</span>
              </div>

              <!-- üí∞ Chi ti·∫øt ƒë∆°n -->
              <div class="order-body">
                <p class="order-total">
                  T·ªïng ti·ªÅn: <strong>{{ order.total | number }}‚Ç´</strong>
                </p>

                <!-- üì¶ Danh s√°ch s·∫£n ph·∫©m -->
                <ul class="order-items">
                  <li *ngFor="let item of order.items">
                    <span class="item-name">{{ item.name }}</span>
                    <span class="item-qty">x {{ item.qty }}</span>
                  </li>
                </ul>
              </div>
            </div>
          </div>

          <!-- ‚ùå Kh√¥ng c√≥ ƒë∆°n h√†ng -->
          <ng-template #noOrder>
            <p class="no-order">B·∫°n ch∆∞a c√≥ ƒë∆°n h√†ng n√†o.</p>
          </ng-template>
        </div>
      </div>
    </div>
  </section>
</main>